{% extends "base.html" %}

{% block title %}Dashboard - Agent Memory{% endblock %}

{% block content %}
<h1>Agent Memory Dashboard</h1>

<div class="grid">
    <!-- Stats Card -->
    <div class="card">
        <h3>Overview</h3>
        <div id="stats-container" hx-get="/stats" hx-trigger="load, every 30s">
            <p>Loading stats...</p>
        </div>
    </div>
    
    <!-- Recent Domains -->
    <div class="card">
        <h3>Recent Domains</h3>
        {% if domains %}
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Created</th>
                </tr>
            </thead>
            <tbody>
                {% for d in domains %}
                <tr>
                    <td><a href="/domains/{{ d.id }}">{{ d.name }}</a></td>
                    <td>{{ d.created_at[:10] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <p style="margin-top: 1rem;"><a href="/domains" class="btn btn-secondary">View All</a></p>
        {% else %}
        <p>No domains yet. <a href="/domains">Create one</a>.</p>
        {% endif %}
    </div>
    
    <!-- Recent Activity -->
    <div class="card">
        <h3>Recent Items</h3>
        {% if recent_items %}
        <table>
            <thead>
                <tr>
                    <th>Domain</th>
                    <th>Item</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for item in recent_items %}
                <tr>
                    <td>{{ item.domain_name }}</td>
                    <td>{{ item.title }}</td>
                    <td><span class="badge badge-{{ item.status }}">{{ item.status }}</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No items yet.</p>
        {% endif %}
    </div>
    
    <!-- Recent Memory -->
    <div class="card">
        <h3>Recent Memory</h3>
        {% if recent_memories %}
        <ul style="list-style: none;">
            {% for mem in recent_memories %}
            <li style="margin-bottom: 0.5rem;">
                <a href="/memory/view/episodic/{{ mem.name }}">{{ mem.name }}</a>
                <span style="color: #8b949e; font-size: 0.875rem;">{{ mem.modified }}</span>
            </li>
            {% endfor %}
        </ul>
        <p style="margin-top: 1rem;"><a href="/memory" class="btn btn-secondary">Browse All</a></p>
        {% else %}
        <p>No memory files found.</p>
        {% endif %}
    </div>
</div>

<div class="card" style="margin-top: 2rem;">
    <h3>Quick Actions</h3>
    <p>
        <a href="/chat" class="btn">Chat with Agent</a>
        <a href="/domains" class="btn btn-secondary">Manage Domains</a>
        <a href="/memory" class="btn btn-secondary">Browse Memory</a>
    </p>
    <p style="margin-top: 1rem; color: #8b949e; font-size: 0.875rem;">
        Database: {{ db_path }}
    </p>
</div>
{% endblock %}
